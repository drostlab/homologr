<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Genome-wide pairwise inference of synonymous versus non-synonymous substitution rates (dnds) — dnds • homologr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Genome-wide pairwise inference of synonymous versus non-synonymous substitution rates (dnds) — dnds" />
<meta property="og:description" content="This function takes the CDS files of two organisms of interest (query and subject)
and computes the dNdS estimation values for orthologous gene pairs between these organisms." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">homologr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Genome-wide pairwise inference of synonymous versus non-synonymous substitution rates (dnds)</h1>
    
    <div class="hidden name"><code>dnds.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function takes the CDS files of two organisms of interest (query and subject)
and computes the dNdS estimation values for orthologous gene pairs between these organisms.</p>
    </div>

    <pre class="usage"><span class='fu'>dnds</span>(
  <span class='kw'>query</span>,
  <span class='kw'>subject</span>,
  format = <span class='st'>"fasta"</span>,
  ortho_detection = <span class='st'>"DIAMOND-RBH"</span>,
  delete_corrupt_cds = <span class='fl'>FALSE</span>,
  store_locally = <span class='fl'>FALSE</span>,
  sensitivity_mode = <span class='st'>"ultra-sensitive"</span>,
  out_format = <span class='st'>"csv"</span>,
  evalue = <span class='st'>"1E-5"</span>,
  max_target_seqs = <span class='fl'>5000</span>,
  cores = <span class='fl'>1</span>,
  hard_mask = <span class='fl'>TRUE</span>,
  diamond_exec_path = <span class='kw'>NULL</span>,
  add_makedb_options = <span class='kw'>NULL</span>,
  add_diamond_options = <span class='kw'>NULL</span>,
  aa_aln_type = <span class='st'>"pairwise"</span>,
  aa_aln_tool = <span class='st'>"NW"</span>,
  codon_aln_tool = <span class='st'>"pal2nal"</span>,
  dnds_estimation = <span class='st'>"Li"</span>,
  output_path = <span class='kw'>NULL</span>,
  quiet = <span class='fl'>TRUE</span>,
  clean_folders = <span class='fl'>FALSE</span>,
  print_citation = <span class='fl'>TRUE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>query</th>
      <td><p>a character string specifying the path to the CDS file of interest (query organism).</p></td>
    </tr>
    <tr>
      <th>subject</th>
      <td><p>a character string specifying the path to the CDS file of interest (subject organism).</p></td>
    </tr>
    <tr>
      <th>format</th>
      <td><p>a character string specifying the file format of the sequence file, e.g. <code>format = "fasta"</code>, <code>format = "gbk"</code>. See
<code><a href='import_proteome.html'>import_proteome</a></code> for more details.</p></td>
    </tr>
    <tr>
      <th>ortho_detection</th>
      <td><p>a character string specifying the orthology inference method that shall be performed to detect orthologous genes. Options are:</p><ul>
<li><p><code>ortho_detection ="DIAMOND-BH"</code>: DIAMOND unidirectional best hit.</p></li>
<li><p><code>ortho_detection = "DIAMOND-RBH"</code>: DIAMOND reciprocal/bidirectional best hit (Default).</p></li>
</ul></td>
    </tr>
    <tr>
      <th>delete_corrupt_cds</th>
      <td><p>a logical value indicating whether sequences with corrupt base triplets should be removed from the input <code>file</code>. This is the case when the length of coding sequences cannot be divided by 3 and thus the coding sequence contains at least one corrupt base triplet.</p></td>
    </tr>
    <tr>
      <th>store_locally</th>
      <td><p>a logical value indicating whether or not alignment files shall be stored locally rather than in <code><a href='https://rdrr.io/r/base/tempfile.html'>tempdir()</a></code>.</p></td>
    </tr>
    <tr>
      <th>sensitivity_mode</th>
      <td><p>specify the level of alignment sensitivity. The higher the sensitivity level, the more deep homologs can be found, but at the cost of reduced computational speed.</p><ul>
<li><p><code>sensitivity_mode = "fast"</code> : fastest alignment mode, but least sensitive (default). Designed for finding hits of &gt;70<!-- % identity and short read alignment such as NGS reads. --></p></li>
<li><p><code>sensitivity_mode = "mid-sensitive"</code> : fast alignments between the <code>fast</code> mode and the sensitive mode in sensitivity.</p></li>
<li><p><code>sensitivity_mode = "sensitive"</code> : fast alignments, but full sensitivity for hits &gt;40<!-- % identity. --></p></li>
<li><p><code>sensitivity_mode = "more-sensitive"</code> : more sensitive than the <code>sensitive</code> mode.</p></li>
<li><p><code>sensitivity_mode = "very-sensitive"</code> : sensitive alignment mode.</p></li>
<li><p><code>sensitivity_mode = "ultra-sensitive"</code> : most sensitive alignment mode (sensitivity as high as BLASTP).</p></li>
</ul></td>
    </tr>
    <tr>
      <th>out_format</th>
      <td><p>a character string specifying the format of the file in which the DIAMOND results shall be stored.
Available options are:</p><ul>
<li><p><code>out_format = "pair"</code> : Pairwise</p></li>
<li><p><code>out_format = "xml"</code> : XML</p></li>
<li><p><code>out_format = "csv"</code> : Comma-separated file</p></li>
</ul></td>
    </tr>
    <tr>
      <th>evalue</th>
      <td><p>Expectation value (E) threshold for saving hits (default: <code>evalue = 0.001</code>).</p></td>
    </tr>
    <tr>
      <th>max_target_seqs</th>
      <td><p>maximum number of aligned sequences that shall be retained. Please be aware that <code>max_target_seqs</code> selects best hits based on the database entry and not by the best e-value. See details here: https://academic.oup.com/bioinformatics/advance-article/doi/10.1093/bioinformatics/bty833/5106166 .</p></td>
    </tr>
    <tr>
      <th>cores</th>
      <td><p>number of cores for parallel DIAMOND searches.</p></td>
    </tr>
    <tr>
      <th>hard_mask</th>
      <td><p>shall low complexity regions be hard masked with TANTAN? Default is <code>db_hard_mask = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>diamond_exec_path</th>
      <td><p>a path to the DIAMOND executable or <code>conda/miniconda</code> folder.</p></td>
    </tr>
    <tr>
      <th>add_makedb_options</th>
      <td><p>a character string specifying additional makedb options that shall be passed on to the diamond makedb command line call, e.g. <code>add_make_options = "--taxonnames"</code> (Default is <code>add_diamond_options = NULL</code>).</p></td>
    </tr>
    <tr>
      <th>add_diamond_options</th>
      <td><p>a character string specifying additional diamond options that shall be passed on to the diamond command line call, e.g. <code>add_diamond_options = "--block-size 4.0 --compress 1 --no-self-hits"</code> (Default is <code>add_diamond_options = NULL</code>).</p></td>
    </tr>
    <tr>
      <th>aa_aln_type</th>
      <td><p>a character string specifying the amino acid alignement type:</p><ul>
<li><p><code>aa_aln_type</code> = "pairwise" (default)</p></li>
</ul></td>
    </tr>
    <tr>
      <th>aa_aln_tool</th>
      <td><p>a character string specifying the program that should be used e.g. "NW" (Needleman-Wunsch Global Alignments).</p></td>
    </tr>
    <tr>
      <th>codon_aln_tool</th>
      <td><p>a character string specifying the codon alignment tool that shall be used. Default is <code>codon_aln_tool = "pal2nal"</code>.
Right now only "pal2nal" can be selected as codon alignment tool.</p></td>
    </tr>
    <tr>
      <th>dnds_estimation</th>
      <td><p>the dNdS estimation method that shall be used.
Options are:</p><ul>
<li><p><code>dnds_estimation = "Li"</code> (Default): Li's method</p></li>
</ul></td>
    </tr>
    <tr>
      <th>output_path</th>
      <td><p>a path to the location were the DIAMOND best hit output shall be stored. E.g. <code>output_path</code> = <code><a href='https://rdrr.io/r/base/getwd.html'>getwd()</a></code>
to store it in the current working directory, or <code>output_path</code> = <code><a href='https://rdrr.io/r/base/file.path.html'>file.path("put", "your", "path", "here")</a></code>.</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>a logical value specifying whether the output of the corresponding alignment tool shall be printed out to the console.
Default is <code>quiet</code> = <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>clean_folders</th>
      <td><p>a logical value specifying whether all internal folders storing the output of used programs
shall be removed. Default is <code>clean_folders</code> = <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>print_citation</th>
      <td><p>a logical value indicating whether or not the citation message shall be printed.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A tibble storing the dnds values of orthologous genes.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The dN/dS ratio quantifies the mode and strength of selection acting on a pair of orthologous genes.
This selection pressure can be quantified by comparing synonymous substitution rates (dS) that are assumed to be neutral
with nonsynonymous substitution rates (dN), which are exposed to selection as they
change the amino acid composition of a protein (Mugal et al., 2013 http://mbe.oxfordjournals.org/content/31/1/212).</p>
<p>The <span class="pkg">homologr</span> package provides the <code>dnds</code> function to perform dNdS estimation on pairs of orthologous genes.
This function takes the CDS files of two organisms of interest (<code>query</code> and <code>subject</code>)
and computes the dN/dS estimation values for orthologous gene pairs between these organisms.</p>
<p>The following pipeline resembles the dN/dS estimation process:</p>
<ul>
<li><p>1) Orthology Inference: e.g. DIAMOND reciprocal best hit (DIAMOND-RBH)</p></li>
<li><p>2) Pairwise sequence alignment: e.g. global pairwise alignments with Needleman-Wunsch</p></li>
<li><p>3) Codon Alignment: e.g. pal2nal program</p></li>
<li><p>4) dNdS estimation: e.g. Li's method</p></li>
</ul><p>Note: it is assumed that when using <code>dnds()</code> all corresponding multiple sequence alignment programs you
want to use are already installed on your machine and are executable via either
the default execution <code>PATH</code> or you specifically define the location of the executable file
via the <code>aa_aln_path</code> or <code>blast_path</code> argument that can be passed to <code>dnds()</code>.</p>
<p>The <code>dnds()</code> function can be used choosing the following options:</p>
<ul>
<li><p><code>ortho_detection</code> :</p><ul>
<li><p><code>"DIAMOND-RBH"</code> (DIAMOND best reciprocal hit)</p></li>
<li><p><code>"DIAMOND-BH"</code> (DIAMOND best hit)</p></li>
</ul></li>
<li><p><code>aa_aln_type</code> :</p><ul>
<li><p><code>"pairwise"</code></p></li>
</ul></li>
<li><p><code>aa_aln_tool</code> :</p></li>
<li><p><code>"NW"</code> (in case <code>aa_aln_type = "pairwise"</code>)</p></li>
<li><p><code>codon_aln_tool</code> :</p><ul>
<li><p><code>"pal2nal"</code></p></li>
</ul></li>
<li><p><code>dnds_estimation</code> :</p><ul>
<li><p>"Li" : Li's method</p></li>
</ul></li>
</ul>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>seqinr: <a href='http://seqinr.r-forge.r-project.org/'>http://seqinr.r-forge.r-project.org/</a></p>
<p>Li, W.-H., Wu, C.-I., Luo, C.-C. (1985) A new method for estimating synonymous and nonsynonymous rates of nucleotide substitution considering the relative likelihood of nucleotide and codon changes. Mol. Biol. Evol, 2:150-174</p>
<p>Li, W.-H. (1993) Unbiased estimation of the rates of synonymous and nonsynonymous substitution. J. Mol. Evol., 36:96-99.</p>
<p>Pamilo, P., Bianchi, N.O. (1993) Evolution of the Zfx and Zfy genes: Rates and interdependence between genes. Mol. Biol. Evol, 10:271-281</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='diamond_best_hits.html'>diamond_best_hits</a></code>, <code><a href='diamond_reciprocal_best_hits.html'>diamond_reciprocal_best_hits</a></code>,
<code><a href='dnds_across_multiple_species.html'>dnds_across_multiple_species</a></code>, <code><a href='import_dnds_tbl.html'>import_dnds_tbl</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Hajk-Georg Drost</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>if</span> (<span class='fl'>FALSE</span>) {

<span class='co'># get a dnds table using:</span>
<span class='co'># 1) reciprocal best hit for orthology inference (DIAMOND-RBH)</span>
<span class='co'># 2) Needleman-Wunsch for pairwise amino acid alignments</span>
<span class='co'># 3) pal2nal for codon alignments</span>
<span class='co'># 4) Li for dNdS estimation</span>
<span class='co'># 5) single core processing 'cores = 1'</span>
<span class='kw'>result</span> <span class='op'>&lt;-</span> <span class='fu'>dnds</span>(quer      = <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>'seqs/ortho_thal_cds.fasta'</span>, package = <span class='st'>'homologr'</span>),
     subject    = <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>'seqs/ortho_lyra_cds.fasta'</span>, package = <span class='st'>'homologr'</span>),
     ortho_detection = <span class='st'>"DIAMOND-RBH"</span>,
     aa_aln_type     = <span class='st'>"pairwise"</span>,
     aa_aln_tool     = <span class='st'>"NW"</span>,
     codon_aln_tool  = <span class='st'>"pal2nal"</span>,
     dnds_estimation = <span class='st'>"Li"</span>,
     cores      = <span class='fl'>1</span> )
<span class='co'># look at output</span>
<span class='kw'>result</span>

<span class='co'># specify the path to the DIAMOND executable if it is not in the system path</span>
<span class='co'># using the 'diamond_exec_path' argument, e.g. diamond_exec_path = "/opt/miniconda3/bin/"</span>
<span class='kw'>result</span> <span class='op'>&lt;-</span> <span class='fu'>dnds</span>(query      = <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>'seqs/ortho_thal_cds.fasta'</span>, package = <span class='st'>'homologr'</span>),
     subject    = <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>'seqs/ortho_lyra_cds.fasta'</span>, package = <span class='st'>'homologr'</span>),
     diamond_exec_path = <span class='st'>"/opt/miniconda3/bin/"</span>,
     ortho_detection = <span class='st'>"DIAMOND-RBH"</span>,
     aa_aln_type     = <span class='st'>"pairwise"</span>,
     aa_aln_tool     = <span class='st'>"NW"</span>,
     codon_aln_tool  = <span class='st'>"pal2nal"</span>,
     dnds_estimation = <span class='st'>"Li"</span>,
     cores      = <span class='fl'>1</span> )
<span class='co'># look at output</span>
<span class='kw'>result</span>
}
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Hajk-Georg Drost.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


